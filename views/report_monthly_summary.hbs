<html>

<head>
    <title>CDS</title>
    <style>
          @font-face {
            font-family: 'THSarabunNew';
            src: url('{{basePath}}/public/fonts/thsarabunnew-webfont.eot');
            src: url('{{basePath}}/public/fonts/thsarabunnew-webfont.eot?#iefix') format('embedded-opentype'),
            url('{{basePath}}/public/fonts/thsarabunnew-webfont.woff') format('woff'),
            url('{{basePath}}/public/fonts/thsarabunnew-webfont.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'THSarabunNew';
            src: url('{{basePath}}/public/fonts/thsarabunnew_bolditalic-webfont.eot');
            src: url('{{basePath}}/public/fonts/thsarabunnew_bolditalic-webfont.eot?#iefix') format('embedded-opentype'),
            url('{{basePath}}/public/fonts/thsarabunnew_bolditalic-webfont.woff') format('woff'),
            url('{{basePath}}/public/fonts/thsarabunnew_bolditalic-webfont.ttf') format('truetype');
            font-weight: bold;
            font-style: italic;

        }

        @font-face {
            font-family: 'THSarabunNew';
            src: url('{{basePath}}/public/fonts/thsarabunnew_italic-webfont.eot');
            src: url('{{basePath}}/public/fonts/thsarabunnew_italic-webfont.eot?#iefix') format('embedded-opentype'),
            url('{{basePath}}/public/fonts/thsarabunnew_italic-webfont.woff') format('woff'),
            url('{{basePath}}/public/fonts/thsarabunnew_italic-webfont.ttf') format('truetype');
            font-weight: normal;
            font-style: italic;

        }

        @font-face {
            font-family: 'THSarabunNew';
            src: url('{{basePath}}/public/fonts/thsarabunnew_bold-webfont.eot');
            src: url('{{basePath}}/public/fonts/thsarabunnew_bold-webfont.eot?#iefix') format('embedded-opentype'),
            url('{{basePath}}/public/fonts/thsarabunnew_bold-webfont.woff') format('woff'),
            url('{{basePath}}/public/fonts/thsarabunnew_bold-webfont.ttf') format('truetype');
            font-weight: bold;
            font-style: normal;
      }
        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-Thin.ttf') format('truetype');
            font-weight: 100;
            font-style: normal;
        }

        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-ExtraLight.ttf') format('truetype');
            font-weight: 200;
            font-style: normal;
        }

        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-Light.ttf') format('truetype');
            font-weight: 300;
            font-style: normal;
        }

        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-Regular.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-Medium.ttf') format('truetype');
            font-weight: 500;
            font-style: normal;
        }

        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-SemiBold.ttf') format('truetype');
            font-weight: 600;
            font-style: normal;
        }

        @font-face {
            font-family: 'IBM Plex Sans Thai';
            src: url('{{basePath}}/public/fonts/IBMPlexSansThai-Bold.ttf') format('truetype');
            font-weight: 700;
            font-style: normal;
        }

        body {

            font-size: 8pt;
        }




        .text-head {
            text-align: center;
            font-weight: normal;
            font-size: 10pt;
        }

        .text-line {
            border: 1px solid black;
        }

        .column {
            float: left;
            width: 50%;
        }

        .column-4 {
            float: left;
            width: 25%;
        }

        .grid-item {
            display: grid;
            grid-template-columns: auto auto auto;
        }

        .left-align {
            text-align: left;
            margin-left: 5px;
        }

        .right-align {
            text-align: right;
            margin-right: 5px;
        }

        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        .ballot-box {
            font-family: 'Roboto', sans-serif;
            font-size: 25px;
            font-weight: bold;
            margin-right: 5px;
            width: 25px;
            height: 25px;
        }

        .ballot-box-check:after {
            content: ' \2611';
        }

        .underline {
                {
                    {
                    !-- width: calc(100% - 100px);
                    --
                }
            }

            width: calc(100%);
            border-bottom: 1px dotted black;
            margin-left: 3px;
            margin-right: 3px;
            flex: 1;
        }

        ul {
            list-style-type: none;
            padding-left: 0;
        }

        li p {
            display: inline-block;
        }

        .item-complain {
                {
                    {
                    !-- margin-left: 25px;
                    --
                }
            }
        }

        .item-complain> :first-child {
            margin-right: 10px;
        }

        .text-center {
            text-align: center;
        }

        .icon-check {
            width: 16px;
        }

        table,
        td {

            font-size: 7pt;
            padding: 5px;
        }

        .parent-underline {
            display: flex;
        }

        .center {
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid;
            border-spacing: 0 10px;
        }

        thead {
            display: table-header-group;
            break-inside: avoid;
        }

        thead>tr>td {
            text-align: center;
            border: 1px solid;
        }

        tbody>tr>td {
            border-left: 1px solid;
            border-right: 1px solid;
        }

        thead::before {
            border: 0px solid;
        }

        .containera4 {
            width: 100%;
            height: 725px;
            border: 0px solid red;
            margin-top: -10px;
            font-family: 'IBM Plex Sans Thai' !important font-weight: 100;
        }

        .containera4 p,
        h1,
        h2,
        h3,
        h4,
        h5 {
            margin: 0px 0px;
        }

        .containera4 table {
            border: 0px solid black;
            height: 100%;
            width: 100%;
            margin: 0px 0px 0px 0px;
        }

        .containera4 tr {
            border: 0px solid black;
        }

        .containera4 td {
            border: 0px solid black;
        }

        .headpdf {
            color: #fff;
            border: 0px solid rgb(255, 191, 0);
            font-size: 25px;

        }

        .headerbox {
            width: 100%;
            height: 50px;
            background-color: #368EE5;
            border-radius: 7px;
            border: 0px solid #368EE5;
            margin: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            /* จัดให้อยู่กลางตามแนวนอนของ .containera4 */
        }

        containera4>table>tr>td {
            font-family: 'IBM Plex Sans Thai'
        }

        .data-table {
            font-family: 'THSarabunNew'
        }

        .apexcharts-yaxis-label {
            white-space: nowrap !important;
            overflow: visible !important;
            text-overflow: initial !important;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<body>


    <div id="loadingchart" style="display: none;">wait</div>

    <div class="containera4">
        <table style="width: 100%; height: 100%; font-family: 'IBM Plex Sans Thai' !important;">
            <tr>
                <td colspan="3" style="height: 30px;">
                    <div class="headerbox">
                        <h1 class="headpdf">สรุปรายงานเรื่องร้องเรียนร้องทุกข์ ประจำเดือน{{thaiMonth}}</h1>
                    </div>
                </td>
            </tr>
            <tr style="padding-top: 20px; font-family: 'IBM Plex Sans Thai';height:500px;">
                <td style="width: 200px; padding: 5px;">
                    <div
                        style="display: flex; flex-direction: column; gap: 10px; border : 0px solid red ; height:540px ;margin-top:20px; font-size:large;">
                         
                        <div
                            style="padding: 0px 5px; background-color: #F5F5F5; border-radius: 4px; padding: 10px; height:80px; width:200px">
                            <p>จำนวนเรื่อง</p>
                            <h1 style="color: #0075E9;">{{complaintDataNumber.complaintTotal}}</h1>
                        </div>
                        <div style="padding: 0px 5px;  padding: 10px; width:200px">
                            <p>ยุติ (รายการ)</p>
                            <h1 style="color: #43BE6D;">{{complaintDataNumber.complaintEnd}}</h1>
                        </div>
                        <div style="padding: 0px 5px;background-color: #F5F5F5; padding: 10px; width:200px">
                            <p>กำลังดำเนินการ (รายการ)</p>
                            <h1 style="color: #FF4A4A;">{{complaintDataNumber.complaintInprogress}}</h1>
                        </div>
                        <div
                            style="padding: 0px 5px; border-radius: 4px; padding: 10px; height:80px; width:200px">
                            <p>รับเรื่อง (รายการ)</p>
                            <h1 style="color: #F1E14A;">{{complaintDataNumber.complainRecive}}</h1>
                        </div>
                        {{!-- <div>
                            <img src="{{basePath}}/public/icons/mascot.svg" alt="Mascot Icon">
                        </div> --}}
                    </div>
                </td>
                <td style="padding: 10px;">
                    <div style="display: flex; justify-content:center;">

                        <div
                            style="padding: 5px; background-color: #F5F5F5; border-radius: 5px; padding: 10px; width: 345px; height:520px ; margin-top:20px; padding: 10px 25px">
                            <h1 style="margin-bottom: 10px;">ช่องทางการร้องเรียนร้องทุกข์ (เรื่อง)</h1>

                            {{#each complaint.conplaintData}}
                            <div style="display: flex; flex-wrap: nowrap; justify-content: space-between;">
                                <div>
                                    <p style="font-size: 15px;">{{mas_name}}</p>
                                </div>
                                <div>
                                    <p style="font-size: 15px;">{{result}}</p>
                                </div>
                            </div>
                            {{/each}}
                        </div>
                    </div>
                </td>
                <td style="padding: 10px;">
                    <div style="display: flex; justify-content:center;">

                        <div
                            style="padding: 5px; background-color: #F5F5F5; border-radius: 5px; padding: 10px; width: 345px; height:520px; margin-top:20px; padding: 10px 25px">
                            <h1 style="margin-bottom: 10px;">ประเภทเรื่องร้องเรียนร้องทุกข์ (เรื่อง)</h1>
                            {{#each complaint.conplaintType}}
                            <div style="display: flex; flex-wrap: nowrap; justify-content: space-between;">
                                <div>
                                    <p style="font-size: 15px;">{{mas_name}}</p>
                                </div>
                                <div>
                                    <p style="font-size: 15px;">{{result}}</p>
                                </div>
                            </div>


                            {{/each}}

                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>


                    <div style="display: flex; align-items:end ;border:0px solid red;height:60px;">
                        <img src="{{basePath}}/public/icons/1146.svg" alt="1146">
                    </div>


                </td>
                <td style="text-align: end;" colspan="2">
                    <div
                        style="display: flex; align-items:end ; justify-content:end; border:0px solid red;height:60px;">
                        <div style="border: 0px solid red;">
                            <h2>สำนักงานเลขานุการกรม</h2>
                            <p style="">กลุ่มบริหารข้อมูลข่าวสารและเรื่องราวร้องทุกข์</p>
                        </div>
                    </div>

                </td>
            </tr>
        </table>
    </div>
    <div class="containera4">
        <table style="width: 100%; height: 100%; font-family: 'IBM Plex Sans Thai' !important; margin-top:30px">
            <tr>
                <td colspan="2" style="height: 30px;">
                    <div class="headerbox">
                        <h1 class="headpdf">สรุปรายงานเรื่องร้องเรียนร้องทุกข์ ประจำเดือน{{thaiMonth}}</h1>
                    </div>
                </td>
            </tr>
            <tr style="padding-top: 20px; font-family: 'IBM Plex Sans Thai';height:250px;">
                <td colspan="2">
                    <div style="background-color:#FAFAFA; padding:5px ; border-radius:10px;">
                        <h1>เปรียบเทียบสถิติเรื่องร้องเรียน ปี {{yearbefore}}-{{yearnow}}</h1>
                        <div id="chart1"></div>
                    </div>
                </td>
            </tr>
            <tr style="padding-top: 20px; font-family: 'IBM Plex Sans Thai';height:250px;">
                <td colspan="2">
                        <div style="background-color:#FAFAFA; padding:5px ; border-radius:10px;">
                        <h1>เรื่องร้องเรียนร้องทุกข์ผ่านช่องทางต่าง ๆ ({{thaiMonth}})</h1>
                        <div id="chart2" style="align-items: center; display: flex; justify-content: center;"></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="display: flex; align-items:end ;border:0px solid red;height:60px;">
                        <img src="{{basePath}}/public/icons/1146.svg" alt="1146">
                    </div>
                </td>
                <td style="text-align: end;">
                    <div
                        style="display: flex; align-items:end ; justify-content:end; border:0px solid red;height:60px;">
                        <div style="border: 0px solid red;">
                            <h2>สำนักงานเลขานุการกรม</h2>
                            <p style="">กลุ่มบริหารข้อมูลข่าวสารและเรื่องราวร้องทุกข์</p>
                        </div>
                    </div>

                </td>
            </tr>
        </table>
    </div>
    <div class="containera4">
        <table style="width: 100%; height: 100%; font-family: 'IBM Plex Sans Thai' !important; margin-top:30px">
            <tr>
                <td colspan="2" style="height: 30px;">
                    <div class="headerbox">
                        <h1 class="headpdf">สรุปรายงานเรื่องร้องเรียนร้องทุกข์ ประจำเดือน{{thaiMonth}}</h1>
                    </div>
                </td>
            </tr>
            <tr style="padding-top: 20px; font-family: 'IBM Plex Sans Thai';height:250px;">
                <td colspan="2">
                    <div style="background-color:#FAFAFA; padding:5px ; border-radius:10px;">
                        <h1>ประเภทเรื่องร้องเรียนร้องทุกข์ ({{thaiMonth}})</h1>
                        <div style="display: flex; flex-wrap: nowrap;">
                            <div id="chart3"></div>
                            <div style="display: flex; justify-content: space-around; width: 750px;">
                                <div style="width: 350px; ">
                                    {{#each complaintType.complaintType1}}
                                    <div
                                        style="display: flex; flex-wrap: nowrap; justify-content: space-between; margin-top:10px;">
                                        <div>
                                            <p style="font-size: 15px;">
                                                <span
                                                    style="background-color:{{color}}; width:15px; height:15px; border-radius:3px; display:inline-block;">
                                                </span>
                                                {{name}}
                                            </p>
                                        </div>
                                        <div>
                                            <p style="font-size: 15px;">
                                                {{data}} %
                                            </p>
                                        </div>
                                    </div>
                                    {{/each}}
                                </div>
                                <div style="width: 350px;">
                                    {{#each complaintType.complaintType2}}
                                    <div
                                        style="display: flex; flex-wrap: nowrap; justify-content: space-between; margin-top:10px;">
                                        <div>
                                            <p style="font-size: 15px;">
                                                <span
                                                    style="background-color: {{color}}; width:15px; height:15px; border-radius:3px; display:inline-block;">
                                                </span>
                                                {{name}}
                                            </p>
                                        </div>
                                        <div>
                                            <p style="font-size: 15px;">
                                                {{data}} %
                                            </p>
                                        </div>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>

                        </div>
                    </div>
                </td>
            </tr>
            <tr style="padding-top: 20px; font-family: 'IBM Plex Sans Thai';height:250px;">
                <td colspan="2">
                    <div style="background-color:#FAFAFA; padding:5px ; border-radius:10px;">
                        <h1>TOP 3 หน่วยงานที่มีเรื่องร้องเรียนร้องทุกข์มากที่สุด</h1>
                        <div id="chart4"></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="display: flex; align-items:end ;border:0px solid red;height:60px;">
                        <img src="{{basePath}}/public/icons/1146.svg" alt="1146">
                    </div>
                </td>
                <td style="text-align: end;">
                    <div
                        style="display: flex; align-items:end ; justify-content:end; border:0px solid red;height:60px;">
                        <div style="border: 0px solid red;">
                            <h2>สำนักงานเลขานุการกรม</h2>
                            <p style="">กลุ่มบริหารข้อมูลข่าวสารและเรื่องราวร้องทุกข์</p>
                        </div>
                    </div>

                </td>
            </tr>
        </table>
    </div>

    <br>
    <br>
    <br>

    {{#each summarymonth}}

    <div
        style="font-size:10px; width:100%; text-align:center; padding-top:10px; font-family: 'THSarabunNew'; color: #333;">
        <span style="font-family: 'THSarabunNew'; font-size: 16px; font-weight: bold;">แบบรับเรื่องร้องเรียน
            ประจำ{{yearMonth}}</span>
    </div>

    <div class="right-align">
        <p style="color: rgb(255, 84, 220) !important; font-weight: bold; font-family: 'THSarabunNew'; ">{{thiaNumber musname}}</p>
    </div>


    <table class="data-table">
        <thead style="font-weight: bold;">
            <tr>
                <td style="width: 4%;">ลำดับที่</td>
                <td style="width: 8%;">หน่วยงาน</td>
                <td style="width: 8%;">ว/ด/ป</td>
                <td style="width: 35%;">รายละเอียด</td>
                <td>ผลการดำเนินงาน</td>
                <td style="width: 8%;">สถานะ</td>

            </tr>
        </thead>


        <tbody class="center">
            {{#each complaints}}
            <tr>
                <td>{{thiaNumber row_num}}</td>
                <td>{{thiaNumber deptshort}}<br>{{thiaNumber sub_deptshort}}</td>
                <td>{{thiaNumber receive_at}}</td>
                <td class="left-align">
                    <span style="color: rgb(34, 153, 84);">{{mas_name}} </span>:
                    {{thiaNumber road}} {{thiaNumber area}}
                </td>
                <td class="left-align" style="color: rgb(26, 82, 118); font-weight: normal;">
                    {{thiaNumber explanation_result}}
                </td>
                <td>
                    {{status}}
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>
    {{/each}}
    <script>

        /*
        {{{chart1.series}}}
        {{{chart1.categories}}}
        {{{chart3.series}}}
        {{{complaintType.complaintType1.data}}}
        */
       var options1 = {
    series: JSON.parse('{{{chart1.series}}}'),
    chart: {
        type: 'bar',
        height: 160,
        width: 1060,
        toolbar: {
            show: false,
        },
        animations: {
            enabled: false,
        },
        fontFamily: 'IBM Plex Sans Thai',
    },
    theme: {
        fontFamily: 'IBM Plex Sans Thai',
    },
    plotOptions: {
        bar: {
            horizontal: false,  // แนวตั้ง
            columnWidth: '55%',
            endingShape: 'rounded',
            borderRadius: 2,
        },
    },
    dataLabels: {
        enabled: true,
        offsetY: 100,  // ปรับตัวเลขขึ้นจากแท่งกราฟ (ค่าลบจะเลื่อนขึ้น)
        formatter: function (val) {
            if (val === 0) {
                return ''; // ถ้าค่าเป็น 0 ไม่แสดง
            }
            return val; // แสดงค่าปกติ
        },
        style: {
            fontFamily: 'IBM Plex Sans Thai',
            colors: ['#000'],
        },
    },
    stroke: {
        show: true,
        width: 2,
        colors: ['transparent'],
    },
    xaxis: {
        categories: JSON.parse('{{{chart1.categories}}}'),
        labels: {
            style: {
                fontFamily: 'IBM Plex Sans Thai',
            },
        },
    },
    fill: {
        opacity: 1,
    },
    tooltip: {
        enabled: true,
        y: {
            formatter: function (val) {
                return val;
            },
            style: {
                fontFamily: 'IBM Plex Sans Thai',
            },
        }
    },
    colors: ['#0075E9', '#43BE6D'],
};





        var options2 = {
    series: [JSON.parse('{{{chart2.series}}}')],
    chart: {
        type: 'bar',
        height: 300,   // ขนาดกราฟเท่าเดิม
        width: '100%',   // ขนาดกราฟเท่าเดิม
        stacked: false,
        animations: {
            enabled: false,
        },
        toolbar: {
            show: false,
        },
        zoom: {
            enabled: false,
        }, 
        pan: {
            enabled: true,
        },
        fontFamily: 'IBM Plex Sans Thai',
        background: 'rgba(240, 240, 240, 0.8)',
    },
    theme: {
        fontFamily: 'IBM Plex Sans Thai',
    },
    plotOptions: {
        bar: {
            horizontal: true,
            endingShape: 'rounded',
            distributed: false,
            barHeight: '60%',
            columnWidth: '100%',
            borderRadius: 2,
            dataLabels: {
                position: 'top',
            }
        },
    },
    grid: {
        padding: {
            left: 100, // เพิ่มระยะห่างระหว่าง x-axis กับ barchart
        }
    },
    dataLabels: { // ตัวเลข
        enabled: true,
        formatter: function (val) {
            return `${val.toFixed(2)}%`;
        },
        style: {
            fontFamily: 'IBM Plex Sans Thai',
            colors: ['#000'],
        },
        offsetX: 30  // ความห่างของตัวเลข
    }, // ตัวเลข
    stroke: {
        show: true,
        width: 2,
        colors: ['transparent'],
    },
     xaxis: {
        categories: JSON.parse('{{{chart2.categories}}}'),
        min: 0,
        max: 100,
        tickAmount: 2,
        offsetX: 150, // เลื่อนแกน X ไปทางขวา

        labels: {
            formatter: function (val) {
                return `${val}%`;
            },
            maxWidth: ['100%'],
            style: {
                fontFamily: 'IBM Plex Sans Thai',
                fontSize: '14px',
                whiteSpace: 'normal',
                wordWrap: 'break-word',
            },
            offsetX: 0,  // ปรับระยะห่างของ label
        },
    },
    yaxis: {
        labels: {
            formatter: function (val) {
                return `${val}`;
            },
            maxWidth: 1060, // เพิ่ม maxWidth ให้ label ในแกน Y ยาวขึ้น
            colors: 'rgba(0, 128, 0, 0.5)', // สีเขียวอ่อนสำหรับข้อความในแกน Y
            style: {
                fontFamily: 'IBM Plex Sans Thai',
                fontSize: '14px',
                whiteSpace: 'normal', // อนุญาตให้ข้อความขึ้นบรรทัดใหม่
                wordWrap: 'break-word', // ตัดคำและขึ้นบรรทัดใหม่
                overflow: 'visible',
                cssClass: 'test',
            },
            offsetX: 0
        },
    },
    tooltip: {
        enabled: true,
        y: {
            formatter: function (val) {
                return val + '%';
            },
            style: {
                fontFamily: 'IBM Plex Sans Thai',
            },
        },
    },
    fill: {
        opacity: 1,
    },
    colors: ['#0075E9', '#43BE6D'],
};




        var options3 = {
            chart: {
                type: "donut",
                toolbar: {
                    show: false,
                },
                fontFamily: 'IBMPlexSansThai-Regular, Arial, sans-serif',
                animations: {
                    enabled: false,
                },
                width: 300,
                height: 230,
            },
            theme: {
                fontFamily: 'IBM Plex Sans Thai',
            },
            noData: {
                text: "ไม่มีข้อมูล",
                align: "center",
                style: {
                    fontFamily: 'IBM Plex Sans Thai',
                    fontSize: '14px'
                }
            },
            dataLabels: {
                enabled: false,
            },
            legend: {
                show: false,
                fontFamily: 'IBM Plex Sans Thai',
            },
            responsive: [
                {
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 200,
                        },
                    },
                },
            ],
            colors: ['#25507F', '#264B72', '#093563', '#0050A0', '#006AD2', '#007DF8',
                '#0F87FE', '#3098FE', '#3FC8E4', '#6DB6FE', '#9BCDFE', '#C3E0FD'],
            labels: [],
            stroke: {
                width: 0,
            },
            series: JSON.parse('{{{chart3.series}}}')
        };
        var options4 = {
            series: JSON.parse('{{{chart4.series}}}'),
            chart: {
                type: 'bar',
                height: 230,
                width: 1060,
                toolbar: {
                    show: false,
                },
                animations: {
                    enabled: false,
                },
            },
            theme: {
                fontFamily: 'IBM Plex Sans Thai',
            },
            plotOptions: {
                bar: {
                    horizontal: false,
                    columnWidth: '55%',
                    endingShape: 'rounded',
                    borderRadius: 2,
                    dataLabels: {
                        position: 'top'
                    }
                },
            },
            dataLabels: {
                enabled: true,
                style: {
                    fontFamily: 'IBM Plex Sans Thai',
                    colors: ['#000'],
                },
                dropShadow: {
                    enabled: true,
                    top: 1,
                    left: 1,
                    blur: 2,
                    opacity: 0.3
                },
            },
            stroke: {
                show: true,
                width: 2,
                colors: ['transparent'],
            },
            xaxis: {
                categories: JSON.parse('{{{chart4.categories}}}'),
                labels: {
                    style: {
                        fontFamily: 'IBM Plex Sans Thai',
                        fontSize: '12px'
                    }
                }
            },
            yaxis: {
                labels: {
                    style: {
                        fontFamily: 'IBM Plex Sans Thai',
                        fontSize: '12px'
                    }
                }
            },
            fill: {
                opacity: 1,
            },
            tooltip: {
                enabled: true,
                y: {
                    formatter: function (val) {
                        return val;
                    }
                }
            },
            legend: {
                fontFamily: 'IBM Plex Sans Thai',
                fontSize: '14px'
            },
            colors: ['#F1E14A', '#0075E9', '#43BE6D'],
        };



        var chart1 = new ApexCharts(document.querySelector("#chart1"), options1);
        var chart2 = new ApexCharts(document.querySelector("#chart2"), options2);
        var chart3 = new ApexCharts(document.querySelector("#chart3"), options3);
        var chart4 = new ApexCharts(document.querySelector("#chart4"), options4);

        let sumChart = 0;

        function checkAllChartsRendered() {
            if (sumChart === 4) {
                document.getElementById('loadingchart').innerHTML = 'ok';
            }
        }

        chart1.render().then(() => {
            sumChart += 1;
            checkAllChartsRendered();
        });
        chart2.render().then(() => {
            sumChart += 1;
            checkAllChartsRendered();
        });
        chart3.render().then(() => {
            sumChart += 1;
            checkAllChartsRendered();
        });
        chart4.render().then(() => {
            sumChart += 1;
            checkAllChartsRendered();
        });

    </script>
</body>

</html>